(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{24833:(e,s,t)=>{Promise.resolve().then(t.bind(t,94030))},94030:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>P});var n=t(54568),a=t(7620),l=t(70463),i=t(5239),r=t(68350),c=t(6845);let d=(0,t(92068).A)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);var o=t(12494),m=t(58597),x=t(92779),h=t(8049),p=t(64715),j=t(766);function u(e){let{open:s,onOpenChange:t,onSuccess:l}=e,[i,r]=(0,a.useState)({name:"",description:""}),[d,o]=(0,a.useState)(!1),[u,g]=(0,a.useState)(null),v=async()=>{if(!i.name.trim())return void g("List name is required");o(!0),g(null);try{var e;let s=(0,j.ao)(i.name.trim(),(null==(e=i.description)?void 0:e.trim())||void 0);await new Promise(e=>setTimeout(e,500)),console.log("Created new list:",s),r({name:"",description:""}),l(s),t(!1)}catch(e){console.error("Error creating list:",e),g(e.message||"Failed to create list. Please try again.")}finally{o(!1)}},y=i.name.trim().length>0&&!d;return(0,n.jsx)(m.lG,{open:s,onOpenChange:t,children:(0,n.jsxs)(m.Cf,{className:"sm:max-w-md",children:[(0,n.jsxs)(m.c7,{children:[(0,n.jsx)(m.L3,{children:"Create New Company List"}),(0,n.jsx)(m.rr,{children:"Create a new list to organize and track companies."})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(h.J,{htmlFor:"list-name",children:"List Name *"}),(0,n.jsx)(x.p,{id:"list-name",placeholder:"Enter list name...",value:i.name,onChange:e=>r(s=>({...s,name:e.target.value})),disabled:d})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(h.J,{htmlFor:"list-description",children:"Description (Optional)"}),(0,n.jsx)(p.T,{id:"list-description",placeholder:"Optional description for this list...",value:i.description,onChange:e=>r(s=>({...s,description:e.target.value})),disabled:d,rows:3})]}),u&&(0,n.jsx)("div",{className:"p-3 rounded-md bg-red-50 border border-red-200",children:(0,n.jsx)("p",{className:"text-sm text-red-600",children:u})}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,n.jsx)(c.$,{variant:"outline",onClick:()=>t(!1),disabled:d,children:"Cancel"}),(0,n.jsx)(c.$,{onClick:v,disabled:!y,children:d?"Creating...":"Create List"})]})]})]})})}function g(e){let{lists:s,selectedListId:t,onSelectList:l,onListsUpdate:m}=e,[x,h]=(0,a.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.Zp,{children:[(0,n.jsx)(i.aR,{children:(0,n.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,n.jsx)(d,{className:"h-5 w-5"}),"My Lists"]})}),(0,n.jsxs)(i.Wu,{className:"space-y-2",children:[s.map(e=>(0,n.jsx)(c.$,{variant:t===e.id?"default":"ghost",className:"w-full justify-start h-auto p-3",onClick:()=>l(e.id),children:(0,n.jsxs)("div",{className:"flex flex-col items-start gap-1 w-full",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsx)("span",{className:"font-medium truncate",children:e.name}),(0,n.jsx)(r.E,{variant:"secondary",className:"ml-2",children:e.companyIds.length})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,n.jsx)("span",{children:e.createdAt}),(0,n.jsx)("span",{children:"•"}),(0,n.jsx)("span",{className:"Active"===e.status?"text-green-600":"text-gray-500",children:e.status})]})]})},e.id)),0===s.length&&(0,n.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,n.jsx)("p",{className:"text-sm",children:"No lists created yet"}),(0,n.jsx)("p",{className:"text-xs mt-1",children:"Create lists from Company Lookup"})]}),(0,n.jsxs)(c.$,{variant:"outline",className:"w-full mt-4 bg-transparent",onClick:()=>h(!0),children:[(0,n.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Create New List"]})]})]}),(0,n.jsx)(u,{open:x,onOpenChange:h,onSuccess:()=>{h(!1),m&&m()}})]})}var v=t(51598),y=t(90551),N=t(6438),f=t(54366),b=t(38391);function C(e){let{companies:s,selectedCompanies:t,onSelectCompany:a,onSelectAll:l,showLeadScores:i=!1,leadScores:d={},onViewCompany:o,sortable:m=!1}=e,x=s.length>0&&t.length===s.length,h=t.length>0&&t.length<s.length,p=e=>d[e];return(0,n.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,n.jsxs)(y.XI,{children:[(0,n.jsx)(y.A0,{children:(0,n.jsxs)(y.Hj,{children:[(0,n.jsx)(y.nd,{className:"w-12",children:(0,n.jsx)(v.S,{checked:x,onCheckedChange:l,ref:e=>{e&&(e.indeterminate=h)}})}),i&&(0,n.jsx)(y.nd,{children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:["Weighted Score",m&&(0,n.jsx)(f.A,{className:"h-4 w-4"})]})}),(0,n.jsx)(y.nd,{children:"Company Name"}),(0,n.jsx)(y.nd,{children:"Industry"}),(0,n.jsx)(y.nd,{children:"Province"}),(0,n.jsx)(y.nd,{children:"Contact Person"}),(0,n.jsx)(y.nd,{children:"Status"}),(0,n.jsx)(y.nd,{children:"Data Completeness"}),(0,n.jsx)(y.nd,{children:"Last Updated"}),(0,n.jsx)(y.nd,{children:"Owner"}),(0,n.jsx)(y.nd,{className:"w-24",children:"Actions"})]})}),(0,n.jsx)(y.BF,{children:s.map(e=>{var s;let l=p(e.id);return(0,n.jsxs)(y.Hj,{children:[(0,n.jsx)(y.nA,{children:(0,n.jsx)(v.S,{checked:t.includes(e.id),onCheckedChange:s=>a(e.id,s)})}),i&&(0,n.jsx)(y.nA,{children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"font-bold text-lg text-primary",children:[(null==l?void 0:l.normalizedScore)||0,"%"]}),(0,n.jsx)("div",{className:"text-xs text-gray-500",children:l?"".concat(l.score,"/").concat(l.maxPossibleScore):"0/0"}),(e=>{let s=p(e);if(!s)return null;let{matchingSummary:t}=s,a=[];return t.keyword&&a.push({label:"Keyword",score:t.keywordScore}),t.industrial&&a.push({label:"Industry",score:t.industrialScore}),t.province&&a.push({label:"Province",score:t.provinceScore}),t.companySize&&a.push({label:"Size",score:t.companySizeScore}),t.contactStatus&&a.push({label:"Status",score:t.contactStatusScore}),(0,n.jsxs)("div",{className:"flex gap-1 mt-1 flex-wrap",children:[a.length>0?a.slice(0,3).map((e,s)=>(0,n.jsxs)("div",{className:"flex items-center gap-1 text-xs px-2 py-1 rounded bg-green-100 text-green-700",children:[(0,n.jsx)(N.A,{className:"h-3 w-3"}),e.label,": ",e.score,"%"]},s)):(0,n.jsx)("div",{className:"text-xs px-2 py-1 rounded bg-gray-100 text-gray-500",children:"No matches"}),a.length>3&&(0,n.jsxs)("div",{className:"text-xs px-2 py-1 rounded bg-blue-100 text-blue-700",children:["+",a.length-3," more"]})]})})(e.id)]})}),(0,n.jsx)(y.nA,{className:"font-medium",children:(0,n.jsxs)("button",{className:"text-left hover:text-blue-600 transition-colors",onClick:()=>null==o?void 0:o(e),children:[(0,n.jsx)("div",{className:"font-semibold hover:underline cursor-pointer",children:e.companyNameEn}),e.registeredNo&&(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:["Reg: ",e.registeredNo]})]})}),(0,n.jsx)(y.nA,{children:e.industrialName}),(0,n.jsx)(y.nA,{children:e.province}),(0,n.jsx)(y.nA,{children:e.contactPersons.length>0?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:e.contactPersons[0].name}),e.contactPersons[0].phone&&(0,n.jsx)("div",{className:"text-sm text-gray-500",children:e.contactPersons[0].phone}),e.contactPersons[0].email&&(0,n.jsx)("div",{className:"text-sm text-gray-500",children:e.contactPersons[0].email})]}):(0,n.jsx)("span",{className:"text-gray-400",children:"No contact info"})}),(0,n.jsx)(y.nA,{children:(0,n.jsx)(r.E,{className:(e=>{switch(e){case"Active":return"bg-green-100 text-green-800";case"Needs Verification":return"bg-yellow-100 text-yellow-800";case"Invalid":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.verificationStatus),children:e.verificationStatus})}),(0,n.jsx)(y.nA,{children:(0,n.jsxs)("span",{className:"font-medium ".concat((s=e.dataCompleteness)>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600"),children:[e.dataCompleteness,"%"]})}),(0,n.jsx)(y.nA,{className:"text-sm text-gray-500",children:e.lastUpdated}),(0,n.jsx)(y.nA,{className:"text-sm text-gray-500",children:e.createdBy}),(0,n.jsx)(y.nA,{children:(0,n.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>null==o?void 0:o(e),className:"h-8 w-8 p-0",children:(0,n.jsx)(b.A,{className:"h-4 w-4"})})})]},e.id)})})]}),0===s.length&&(0,n.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No companies in this list."})]})}var S=t(88161),w=t(13824),k=t(62063),A=t(387),L=t(84244);let P=(0,k.oC)(["user","admin"])(function(){var e;let[s,t]=(0,a.useState)((null==(e=j.pQ[0])?void 0:e.id)||""),[r,d]=(0,a.useState)([]),[o,m]=(0,a.useState)(!1),[x,h]=(0,a.useState)(!1),[p,u]=(0,a.useState)({}),[v,y]=(0,a.useState)(null),[N,f]=(0,a.useState)(!1),[b,k]=(0,a.useState)(0),P=j.pQ.find(e=>e.id===s),E=(0,a.useMemo)(()=>P?j._J.filter(e=>P.companyIds.includes(e.id)):[],[P,b]),{displayCompanies:O,leadScores:z}=(0,a.useMemo)(()=>{if(!o||0===Object.keys(p).length)return{displayCompanies:E,leadScores:{}};let e=(0,j.pz)(E,p),s=e.map(e=>e.company),t={};return e.forEach(e=>{t[e.company.id]=e.score}),{displayCompanies:s,leadScores:t}},[E,o,p]),M=()=>{u({}),m(!1),d([])};return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)(l.V,{}),(0,n.jsxs)("main",{className:"container mx-auto px-4 py-6",children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"List Management"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Manage your saved company lists and apply smart filtering"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,n.jsx)("div",{className:"lg:col-span-1",children:(0,n.jsx)(g,{lists:j.pQ,selectedListId:s,onSelectList:t,onListsUpdate:()=>k(e=>e+1)})}),(0,n.jsx)("div",{className:"lg:col-span-3 space-y-6",children:P?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Zp,{children:(0,n.jsxs)(i.aR,{children:[(0,n.jsxs)(i.ZB,{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{children:P.name}),(0,n.jsxs)("span",{className:"text-sm font-normal text-gray-500",children:[E.length," companies"]})]}),(0,n.jsxs)(i.BT,{children:["Created on ",P.createdAt," • Status: ",P.status]})]})}),(0,n.jsx)(i.Zp,{children:(0,n.jsxs)(i.aR,{children:[(0,n.jsxs)(i.ZB,{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(A.A,{className:"h-5 w-5"}),"Smart Filtering & Lead Scoring",o&&(0,n.jsx)("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Active"})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)(c.$,{variant:o?"secondary":"outline",size:"sm",onClick:()=>h(!0),children:[(0,n.jsx)(L.A,{className:"h-4 w-4 mr-1"}),"Configure"]}),o&&(0,n.jsx)(c.$,{variant:"outline",size:"sm",onClick:M,children:"Clear"})]})]}),(0,n.jsxs)(i.BT,{children:["Apply intelligent filtering with weighted lead scoring to rank companies in your list.",o&&" Showing ".concat(O.length," companies sorted by weighted score.")]})]})}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)(c.$,{variant:"destructive",onClick:()=>{if(P&&r.length>0)try{let e=(0,j.G8)(P.id,r);console.log("Remove from list result:",e),k(e=>e+1),d([]),alert("Removed ".concat(e.removed.length," companies from list."))}catch(e){console.error("Error removing companies:",e),alert("Error removing companies from list.")}},disabled:0===r.length,children:["Remove from List (",r.length,")"]}),(0,n.jsxs)(c.$,{variant:"outline",onClick:()=>{let e=new Blob([[["Company Name","Industry","Province","Contact Person","Phone","Email","Status","Data Completeness","Lead Score"],...O.filter(e=>r.includes(e.id)).map(e=>{var s,t,n,a;let l=(null==(s=z.find(s=>s.companyId===e.id))?void 0:s.score)||0;return[e.companyNameEn,e.industrialName,e.province,(null==(t=e.contactPersons[0])?void 0:t.name)||"",(null==(n=e.contactPersons[0])?void 0:n.phone)||"",(null==(a=e.contactPersons[0])?void 0:a.email)||"",e.verificationStatus,"".concat(e.dataCompleteness,"%"),showLeadScoring?l.toString():"N/A"]})].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="".concat((null==P?void 0:P.name)||"list","-export-").concat(new Date().toISOString().split("T")[0],".csv"),t.click(),URL.revokeObjectURL(s)},disabled:0===r.length,children:["Export (",r.length,")"]})]}),o&&(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Sorted by weighted score (highest first)"})]}),(0,n.jsx)(C,{companies:O,selectedCompanies:r,onSelectCompany:(e,s)=>{s?d(s=>[...s,e]):d(s=>s.filter(s=>s!==e))},onSelectAll:e=>{e?d(O.map(e=>e.id)):d([])},showLeadScores:o,leadScores:z,onViewCompany:e=>{y(e),f(!0)},sortable:o})]}):(0,n.jsx)(i.Zp,{children:(0,n.jsx)(i.Wu,{className:"text-center py-12",children:(0,n.jsx)("p",{className:"text-gray-500",children:"No lists available. Create a list from the Company Lookup page."})})})})]}),(0,n.jsx)(S.a,{isOpen:x,onOpenChange:h,criteria:p,onApplyFiltering:e=>{u(e),m(!0),d([])},onClearFiltering:M}),(0,n.jsx)(w.i,{company:v,open:N,onOpenChange:f})]})]})})}},e=>{e.O(0,[526,435,159,797,335,563,409,115,949,587,18,358],()=>e(e.s=24833)),_N_E=e.O()}]);